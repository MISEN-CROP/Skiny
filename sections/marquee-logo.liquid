<div class="marquee-logo-container relative py-4">
  <div class="container bg-[var(--bg-second)] mx-auto px-6 py-8 rounded-xl">
    <div class="flex items-center gap-6">
      {% if section.settings.featured_text != blank %}
        <div>
          <span class="font-pr-light">{{ section.settings.featured_text }}: </span>
        </div>
      {% endif %}
      <div class="overflow-hidden flex-1 div-child-full">
        <div id="marquee-{{ section.id }}">
          <div class="flex gap-8 overflow-x-auto no-scrollbar">
            <div class="flex gap-8 overflow-x-auto no-scrollbar">
              {% for block in section.blocks %}
                {% if block.settings.logo != blank %}
                  <a
                    href="{{ block.settings.link | default: '#' }}"
                    {% if block.settings.link == blank %}
                      onclick="return false;"
                    {% endif %}
                  >
                    <img
                      src="{{ block.settings.logo | image_url }}"
                      alt="{{ block.settings.logo.alt | default: 'Logo' }}"
                      loading="lazy"
                      width="{{ block.settings.logo.width | default: 120 }}"
                      height="{{ block.settings.logo.height | default: 60 }}"
                    >
                  </a>
                {% endif %}
              {% endfor %}
            </div>
            <div class="flex gap-8 overflow-x-auto no-scrollbar">
              {% for block in section.blocks %}
                {% if block.settings.logo != blank %}
                  <a
                    href="{{ block.settings.link | default: '#' }}"
                    {% if block.settings.link == blank %}
                      onclick="return false;"
                    {% endif %}
                  >
                    <img
                      src="{{ block.settings.logo | image_url }}"
                      alt="{{ block.settings.logo.alt | default: 'Logo' }}"
                      loading="lazy"
                      width="{{ block.settings.logo.width | default: 120 }}"
                      height="{{ block.settings.logo.height | default: 60 }}"
                    >
                  </a>
                {% endif %}
              {% endfor %}
            </div>
            <div class="flex gap-8 overflow-x-auto no-scrollbar">
              {% for block in section.blocks %}
                {% if block.settings.logo != blank %}
                  <a
                    href="{{ block.settings.link | default: '#' }}"
                    {% if block.settings.link == blank %}
                      onclick="return false;"
                    {% endif %}
                  >
                    <img
                      src="{{ block.settings.logo | image_url }}"
                      alt="{{ block.settings.logo.alt | default: 'Logo' }}"
                      loading="lazy"
                      width="{{ block.settings.logo.width | default: 120 }}"
                      height="{{ block.settings.logo.height | default: 60 }}"
                    >
                  </a>
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (typeof jQuery !== 'undefined' && jQuery.fn.marquee) {
      try {
        $('#marquee-{{ section.id }}').marquee({
          duration: 20000,
          delayBeforeStart: 0,
          direction: 'left',
          duplicated: true,
          pauseOnHover: true,
          startVisible: true,
        });
      } catch (error) {
        document.querySelector('#marquee-{{ section.id }} .marquee-content').classList.add('marquee-fallback');
      }
    } else {
      document.querySelector('#marquee-{{ section.id }} .marquee-content').classList.add('marquee-fallback');
    }
  });
</script>

{% schema %}
{
  "name": "Marquee Logo",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "featured_text",
      "label": "Featured Text",
      "default": "Featured in",
      "info": "Text displayed before the logos"
    }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "Logo",
      "settings": [
        {
          "type": "image_picker",
          "id": "logo",
          "label": "Logo Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Logo Link",
          "info": "Optional link when logo is clicked"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Marquee Logo",
      "settings": {
        "featured_text": "Featured in"
      },
      "blocks": [
        {
          "type": "logo"
        },
        {
          "type": "logo"
        },
        {
          "type": "logo"
        },
        {
          "type": "logo"
        }
      ]
    }
  ]
}
{% endschema %}
