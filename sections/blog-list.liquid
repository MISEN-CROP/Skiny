<div class="blog-list-section py-12 lg:py-16 bg-[var(--bg-second)]">
  <div class="page-container">
    {% if section.settings.heading %}
      <h1 class="text-3xl lg:text-4xl font-medium text-center mb-8 lg:mb-12 font-pr" style="color: var(--gig-primary);">
        {{ section.settings.heading }}
      </h1>
    {% endif %}

    {% assign posts_limit = section.settings.posts_limit | default: 4 %}

    {% assign news_blog = blogs.news %}

    {% if news_blog and news_blog.articles.size > 0 %}
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-{{ section.settings.columns_desktop }} gap-6 lg:gap-8">
        {% for article in news_blog.articles limit: posts_limit %}
          <div class="blog-card group">
            <div class="blog-image-wrapper mb-4 overflow-hidden rounded-lg">
              {% if article.image %}
                <img
                  src="{{ article.image | img_url: '600x400' }}"
                  alt="{{ article.image.alt | default: article.title }}"
                  class="w-full h-112 object-cover object-top transition-transform duration-300 group-hover:scale-105"
                  loading="lazy"
                >
              {% else %}
                <div
                  class="w-full h-64 flex items-center justify-center rounded-lg"
                  style="background-color: var(--gig-bg-1);"
                >
                  <span class="text-lg font-pr-light" style="color: var(--gig-primary);">No Image</span>
                </div>
              {% endif %}
            </div>

            <div class="blog-content">
              {% if section.settings.show_blog_name %}
                <div class="text-xs uppercase mb-2 font-pr opacity-60" style="color: var(--gig-primary);">
                  {{ article.blog.title }}
                </div>
              {% endif %}

              <h3
                class="text-xl lg:text-2xl font-medium font-pr group-hover:opacity-80 transition-opacity"
                style="color: var(--gig-primary);"
              >
                {{ article.title }}
              </h3>

              {% if section.settings.show_excerpt and article.excerpt != blank %}
                <p class="text-base mb-4 font-pr-light leading-relaxed" style="color: var(--gig-primary);">
                  {{ article.excerpt | strip_html | truncate: 120 }}
                </p>
              {% elsif section.settings.show_excerpt and article.content != blank %}
                <p class="text-base mb-4 font-pr-light leading-relaxed" style="color: var(--gig-primary);">
                  {{ article.content | strip_html | truncate: 120 }}
                </p>
              {% endif %}

              {% if section.settings.show_date %}
                <div class="text-sm mb-4 font-pr-light opacity-75" style="color: var(--gig-primary);">
                  {{ article.published_at | date: '%B %d, %Y' }}
                </div>
              {% endif %}

              {% if section.settings.show_author and article.author != blank %}
                <div class="text-sm mb-4 font-pr-light opacity-75" style="color: var(--gig-primary);">
                  By {{ article.author }}
                </div>
              {% endif %}

              <a
                href="{{ article.url }}"
                class="inline-block font-medium transition-all duration-300 ease-in-out hover:text-white font-pr blog-btn"
                style="border-color: var(--gig-primary); color: var(--gig-primary);"
              >
                {{ section.settings.button_text | default: 'Read More' }}
              </a>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-12">
        <p class="text-lg font-pr-light mb-4" style="color: var(--gig-primary);">No blog posts found in News blog.</p>
        <!-- Debug: Show available blogs -->
        <div class="debug-info">
          <p class="text-sm opacity-75 mb-2">Available blogs:</p>
          {% for blog in blogs %}
            <p class="text-sm opacity-75">
              {{ blog.title }} (Handle: {{ blog.handle }}, Articles: {{ blog.articles.size }})
            </p>
          {% endfor %}

          {% if news_blog %}
            <p class="text-sm opacity-75 mt-4">News blog found but has {{ news_blog.articles.size }} articles</p>
          {% else %}
            <p class="text-sm opacity-75 mt-4">News blog not found</p>
          {% endif %}
        </div>
      </div>
    {% endif %}

    {% if section.settings.show_view_all and news_blog and news_blog.articles.size > 0 %}
      <div class="text-center mt-8 lg:mt-12">
        <a
          href="{{ news_blog.url | default: '/blogs' }}"
          class="inline-block px-8 py-3 border-2 rounded-full font-medium transition-all duration-300 ease-in-out hover:text-white font-pr view-all-btn"
          style="border-color: var(--gig-primary); color: var(--gig-primary);"
        >
          {{ section.settings.view_all_text | default: 'View All Posts' }}
        </a>
      </div>
    {% endif %}
  </div>
</div>

<style>
  .font-pr {
    font-family: var(--font-primary);
  }

  .font-pr-light {
    font-family: var(--font-primary-light);
  }

  .blog-btn:hover,
  .view-all-btn:hover {
    background-color: var(--gig-primary) !important;
    color: var(--gig-white) !important;
  }

  .blog-btn {
    border-bottom: 1px solid var(--gig-primary);
    font-size: 12px;
  }

  .blog-card {
    transition: transform 0.3s ease;
  }

  .blog-card:hover {
    transform: translateY(-4px);
  }

  @media (max-width: 768px) {
    .grid {
      grid-template-columns: 1fr;
    }
  }

  @media (min-width: 769px) and (max-width: 1023px) {
    .grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
</style>

{% schema %}
{
  "name": "Blog List",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "General Settings"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "SHOP LAURYN'S ROUTINE"
    },
    {
      "type": "range",
      "id": "posts_limit",
      "label": "Number of posts to show",
      "min": 2,
      "max": 24,
      "step": 1,
      "default": 4
    },
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "select",
      "id": "columns_desktop",
      "label": "Desktop columns",
      "options": [
        {
          "value": "2",
          "label": "2 columns"
        },
        {
          "value": "3",
          "label": "3 columns"
        },
        {
          "value": "4",
          "label": "4 columns"
        }
      ],
      "default": "2"
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "checkbox",
      "id": "show_blog_name",
      "label": "Show blog name",
      "default": true,
      "info": "Show which blog each article comes from"
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "Show article excerpt",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "Show published date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "Show author name",
      "default": false
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Read more button text",
      "default": "Read More"
    },
    {
      "type": "header",
      "content": "View All Settings"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show 'View All' button",
      "default": true
    },
    {
      "type": "text",
      "id": "view_all_text",
      "label": "View all button text",
      "default": "View All Posts"
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View all button link",
      "info": "Leave empty to use default /blogs page"
    }
  ],
  "presets": [
    {
      "name": "Blog List"
    }
  ]
}
{% endschema %}
