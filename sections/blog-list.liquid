<div class="blog-list-section py-8 bg-[var(--bg-second)]">
  <div class="page-container">
    {% if section.settings.heading %}
      <div class="text-center mb-12 lg:mb-16">
        <h1 class="text-3xl lg:text-5xl font-bold mb-4 font-pr animate-fade-in" style="color: var(--gig-primary);">
          {{ section.settings.heading }}
        </h1>
      </div>
    {% endif %}
    {% assign posts_limit = section.settings.posts_limit | default: 4 %}
    {% assign news_blog = blogs.blog %}

    {% if news_blog and news_blog.articles.size > 0 %}
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-{{ section.settings.columns_desktop }} gap-8 lg:gap-10">
        {% for article in news_blog.articles limit: posts_limit %}
          <article class="blog-card group bg-[var(--bg-gis-second-primary)] rounded-2xl overflow-hidden transition-all duration-500 transform hover:-translate-y-2">
            <div class="blog-image-wrapper relative overflow-hidden">
              {% if article.image %}
                <div class="aspect-[4/3] overflow-hidden">
                  <img
                    src="{{ article.image | img_url: '800x600' }}"
                    alt="{{ article.image.alt | default: article.title }}"
                    class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                    loading="lazy"
                  >
                </div>
                <div
                  class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"
                ></div>
              {% else %}
                <div class="aspect-[4/3] flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200">
                  <div class="text-center">
                    <svg
                      class="w-16 h-16 mx-auto mb-2 text-gray-400"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <span class="text-sm font-medium text-gray-500">No Image</span>
                  </div>
                </div>
              {% endif %}

              {% if section.settings.show_date %}
                <div class="absolute top-4 left-4 bg-white/90 backdrop-blur-sm rounded-lg px-3 py-1 shadow-sm">
                  <time class="text-xs font-semibold" style="color: var(--gig-primary);">
                    {{ article.published_at | date: '%b %d' }}
                  </time>
                </div>
              {% endif %}
            </div>

            <div class="blog-content p-6 lg:p-8">
              <h3
                class="blog-title text-xl lg:text-2xl font-bold mb-4 font-pr leading-tight group-hover:text-opacity-80 transition-all duration-300"
                style="color: var(--gig-primary);"
              >
                <a href="{{ article.url }}" class="hover:underline decoration-2 underline-offset-4">
                  {{ article.title }}
                </a>
              </h3>

              {% if section.settings.show_excerpt and article.excerpt != blank %}
                <p class="text-gray-600 mb-6 font-pr-light leading-relaxed line-clamp-3">
                  {{ article.excerpt | strip_html | truncate: 150 }}
                </p>
              {% elsif section.settings.show_excerpt and article.content != blank %}
                <p class="text-gray-600 mb-6 font-pr-light leading-relaxed line-clamp-3">
                  {{ article.content | strip_html | truncate: 150 }}
                </p>
              {% endif %}

              <div class="flex items-center justify-between">
                {% if section.settings.show_author and article.author != blank %}
                  <div class="flex items-center space-x-2">
                    <div
                      class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold text-white"
                      style="background: linear-gradient(45deg, var(--gig-primary), var(--gig-accent, #f59e0b));"
                    >
                      {{ article.author | slice: 0 }}
                    </div>
                    <span class="text-sm font-medium text-gray-700">{{ article.author }}</span>
                  </div>
                {% endif %}

                <a
                  href="{{ article.url }}"
                  class="read-more-btn inline-flex items-center space-x-2 text-sm font-semibold transition-all duration-300 group/btn"
                  style="color: var(--gig-primary);"
                >
                  <span>{{ section.settings.button_text | default: 'Read More' }}</span>
                  <svg
                    class="w-4 h-4 transition-transform duration-300 group-hover/btn:translate-x-1"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </a>
              </div>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-20">
        <div class="max-w-md mx-auto">
          <svg class="w-20 h-20 mx-auto mb-6 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9.5a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
          </svg>
          <h3 class="text-xl font-bold mb-2" style="color: var(--gig-primary);">No Blog Posts Found</h3>
          <p class="text-gray-600 mb-8">There are currently no blog posts available in the News section.</p>

          {% comment %} Debug info - remove in production {% endcomment %}
          <details class="text-left bg-gray-50 rounded-lg p-4">
            <summary class="cursor-pointer text-sm font-medium text-gray-700 mb-2">Debug Information</summary>
            <div class="text-xs text-gray-600 space-y-1">
              <p class="font-semibold">Available blogs:</p>
              {% for blog in blogs %}
                <p>{{ blog.title }} ({{ blog.handle }}: {{ blog.articles.size }} articles)</p>
              {% endfor %}
              {% if news_blog %}
                <p class="mt-2">News blog found but has {{ news_blog.articles.size }} articles</p>
              {% else %}
                <p class="mt-2 text-red-600">News blog not found</p>
              {% endif %}
            </div>
          </details>
        </div>
      </div>
    {% endif %}

    {% if section.settings.show_view_all and news_blog and news_blog.articles.size > posts_limit %}
      <div class="text-center mt-16">
        <a
          href="{{ section.settings.view_all_link | default: news_blog.url | default: '/blogs' }}"
          class="view-all-btn inline-flex items-center space-x-3 px-8 py-4 rounded-full font-semibold text-lg transition-all duration-300 transform hover:scale-105 hover:shadow-lg"
          style="border: 2px solid var(--gig-primary); color: var(--gig-primary);"
        >
          <span>{{ section.settings.view_all_text | default: 'View All Posts' }}</span>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
          </svg>
        </a>
      </div>
    {% endif %}
  </div>
</div>

<style>
  .font-pr {
    font-family: var(--font-primary);
  }

  .font-pr-light {
    font-family: var(--font-primary-light);
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .animate-fade-in {
    animation: fadeInUp 0.8s ease-out;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .blog-card {
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .blog-card:hover {
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
  }

  .view-all-btn:hover {
    background-color: var(--gig-primary) !important;
    color: white !important;
    border-color: var(--gig-primary) !important;
  }

  .read-more-btn:hover {
    transform: translateX(2px);
  }

  /* Responsive Grid Enhancement */
  @media (max-width: 640px) {
    .blog-content {
      padding: 1.25rem;
    }

    .blog-list-section {
      padding-top: 3rem;
      padding-bottom: 3rem;
    }
  }

  @media (min-width: 768px) and (max-width: 1023px) {
    .grid {
      gap: 2rem;
    }
  }

  @media (min-width: 1024px) {
    .grid {
      gap: 2.5rem;
    }
  }

  /* Staggered Animation */
  .blog-card:nth-child(1) {
    animation-delay: 0.1s;
  }
  .blog-card:nth-child(2) {
    animation-delay: 0.2s;
  }
  .blog-card:nth-child(3) {
    animation-delay: 0.3s;
  }
  .blog-card:nth-child(4) {
    animation-delay: 0.4s;
  }

  .blog-card {
    animation: slideInUp 0.6s ease-out both;
  }

  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(40px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

{% schema %}
{
  "name": "Blog List",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "General Settings"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "LATEST NEWSTHE LATEST"
    },
    {
      "type": "range",
      "id": "posts_limit",
      "label": "Number of posts to show",
      "min": 2,
      "max": 24,
      "step": 1,
      "default": 6
    },
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "select",
      "id": "columns_desktop",
      "label": "Desktop columns",
      "options": [
        {
          "value": "2",
          "label": "2 columns"
        },
        {
          "value": "3",
          "label": "3 columns"
        },
        {
          "value": "4",
          "label": "4 columns"
        }
      ],
      "default": "3"
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "checkbox",
      "id": "show_blog_name",
      "label": "Show blog name",
      "default": true,
      "info": "Display blog category as a badge"
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "Show article excerpt",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "Show published date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "Show author name",
      "default": true
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Read more button text",
      "default": "Read Article"
    },
    {
      "type": "header",
      "content": "View All Settings"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show 'View All' button",
      "default": true
    },
    {
      "type": "text",
      "id": "view_all_text",
      "label": "View all button text",
      "default": "Explore All Articles"
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View all button link",
      "info": "Leave empty to use default blog page"
    }
  ],
  "presets": [
    {
      "name": "Blog List Page"
    }
  ]
}
{% endschema %}
